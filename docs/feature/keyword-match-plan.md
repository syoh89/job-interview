# 키워드 매칭 정교화 구현 계획

## 목표

- 키워드 자동 링크가 **단어 경계**를 고려해 과매칭을 줄임.
- 숫자/기호 포함 키워드도 안전하게 처리.

## 현재 방식 요약

- `remark` 플러그인에서 텍스트 노드 분할 후 링크화.
- 긴 키워드 우선 매칭, code/link/heading 제외.

## 개선 방향

### 1) 단어 경계 기반 매칭

- 영문 키워드는 **단어 경계(`\b`)** 적용.
- 한글/숫자 혼합 키워드는 **커스텀 경계** 적용:
  - 앞뒤가 공백/구두점/문장 경계일 때만 매칭.
  - 예: `React`는 `React`에만 링크, `ReactNative`는 제외.

### 2) 케이스 처리

- 기본은 **대소문자 구분**(요구사항 준수).
- 옵션으로 `caseInsensitive` 플래그 추가 가능.

### 3) 충돌 방지

- 긴 키워드 우선은 유지.
- 정규식 매칭 시 **중첩 링크 방지**를 위해 인덱스 범위로 분할.

## 구현 전략

### A. 정규식 분기

- 키워드 성격에 따라 다른 패턴 사용:
  - 영문 키워드: `\\bKEYWORD\\b`
  - 한글/숫자 혼합: `(^|[\\s\\p{P}])KEYWORD(?=$|[\\s\\p{P}])`
- 유니코드 구두점(`\\p{P}`) 처리를 위해 `u` 플래그 사용.

### B. 토큰화 방식

- 텍스트를 공백/구두점 기준으로 토큰화.
- 각 토큰별로 키워드 매칭 후 링크화.
- 원본 텍스트 보존을 위해 토큰 사이 구분자 유지.

## 변경 대상

- `src/lib/markdown.ts`
  - `keywordAutoLinkPlugin()` 내부 로직 수정
  - 매칭 규칙/옵션 분기 추가

## 구현 단계

1. 키워드 유형 분류 함수 추가 (영문/한글/혼합).
2. 유형별 정규식 생성 함수 추가.
3. 텍스트 매칭 로직을 인덱스 기반으로 재구성.
4. 유니코드 구두점 처리 테스트 케이스 추가.

## 검증 기준

- `React`가 `ReactNative` 내부에서는 링크화되지 않음.
- `HTTP/2`, `C++` 등 기호 포함 키워드가 정상 링크화.
- 코드/헤딩/이미 링크된 텍스트는 변환 제외.

## 리스크/대응

- 유니코드 정규식 성능 → 키워드 수 증가 시 사전 컴파일 캐시 고려.
